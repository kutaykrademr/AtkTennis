
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@model Helpers.Dto.ViewDtos.HomeModelDto



<div class="content-wrapper">

   
    <div class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1 class="m-0">Dashboard</h1>
                </div>
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="#">Home</a></li>
                        <li class="breadcrumb-item active">Dashboard v1</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

   
    <section class="content">
        <div class="container-fluid">      
            <div class="row">
                <div class="col-lg-3 col-6">                   
                    <div class="small-box bg-warning">
                        <div class="inner">
                            <h3>
                                @if (Model.TotalUserCount == null)
                                {
                                    @Html.Raw("-");
                                }
                                else
                                {
                                    @Model.TotalUserCount
                                }

                            </h3>
                            <p>Toplam Üye Sayısı</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-person-add"></i>
                        </div>
                        <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
              
                <div class="col-lg-3 col-6">
                 
                    <div class="small-box bg-info">
                        <div class="inner">
                            <h3>
                                @if (Model.TotalRoleCount == null)
                                {@Html.Raw("-") ;
                            }
                            else
                            { @Model.TotalRoleCount}
                            </h3>
                            <p>Toplam Yetkiler</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-bag"></i>
                        </div>
                        <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
             
                <div class="col-lg-3 col-6">
                  
                    <div class="small-box bg-success">
                        <div class="inner">
                            @*<h3>53<sup style="font-size: 20px">%</sup></h3>*@

                            <h3>

                                @if (Model.TodayResCount == null)
                                {
                                    @Html.Raw("-") ;
                                }

                                else

                                    @Model.TodayResCount

                            </h3>
                            <p>Bugüne Ait Rezervasyon Sayısı</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-stats-bars"></i>
                        </div>
                        <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
               
                <div class="col-lg-3 col-6">
                   
                    <div class="small-box bg-danger">
                        <div class="inner">
                            <h3>

                                @if (Model.TotalResCount == null)
                                {
                                    @Html.Raw("-") ;
                                }

                                else

                                    @Model.TotalResCount

                            </h3>

                            <p>Toplam Rezervasyon Sayısı</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-pie-graph"></i>
                        </div>
                        <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
               
            </div>
          
            <div class="row">              
                <section class="col-lg-7 connectedSortable">
                   
                    <div class="card card-info">
                        <div class="card-header" style="background-color:darkmagenta">
                            <h3 class="card-title"><i style="margin-right:10px" class="fas fa-tasks"></i>Yapılacak Listesi </h3>

                            <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                                    <i class="fas fa-minus"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body p-0">
                            <ul class="todo-list" data-widget="todo-list">

                                @foreach (var item in Model.toDoLists)
                                {
                                    <li>
                                        <span class="handle">
                                            <i class="fas fa-ellipsis-v"></i>
                                            <i class="fas fa-ellipsis-v"></i>
                                        </span>

                                        <div class="icheck-primary d-inline ml-2">
                                            <input type="checkbox" value="" name="t_@item.ListId" id="@item.ListId">
                                            <label for="@item.ListId"></label>
                                        </div>

                                        <span class="text">@item.ToDo</span>
                                        <small class="badge badge-secondary"><i class="far fa-clock"></i>@item.Date</small>
                                        <div class="tools">
                                            <i class="fas fa-edit"></i>
                                            <i class="fas fa-trash"></i>
                                        </div>
                                    </li>
                                }


                            </ul>
                        </div>
                        <div class="card-footer clearfix">
                            <button data-toggle="modal" data-target="#openToDoModal" style="background-color:darkmagenta; border-color:cornflowerblue" type="button" class="btn btn-info float-right"><i class="fas fa-plus"></i> Ekle</button>
                        </div>                      
                    </div>


                    
                    <div class="card bg-gradient-success">
                        <div class="card-header border-0">

                            <h3 class="card-title">
                                <i class="far fa-calendar-alt"></i>
                                Calendar
                            </h3>
                           
                            <div class="card-tools">                               
                                <div class="btn-group">
                                    <button type="button" class="btn btn-success btn-sm dropdown-toggle" data-toggle="dropdown" data-offset="-52">
                                        <i class="fas fa-bars"></i>
                                    </button>
                                    <div class="dropdown-menu" role="menu">
                                        <a href="#" class="dropdown-item">Add new event</a>
                                        <a href="#" class="dropdown-item">Clear events</a>
                                        <div class="dropdown-divider"></div>
                                        <a href="#" class="dropdown-item">View calendar</a>
                                    </div>
                                </div>
                                <button type="button" class="btn btn-success btn-sm" data-card-widget="collapse">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <button type="button" class="btn btn-success btn-sm" data-card-widget="remove">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                           
                        </div>
                        
                        <div class="card-body pt-0">
                           
                            <div id="calendar" style="width: 100%"></div>
                        </div>                   
                    </div>                    
                </section>



                <section class="col-lg-5 connectedSortable">
                    <div class="card card-info">
                        <div class="card-header">
                            <h3 class="card-title"><i style="margin-right:10px" class="fas fa-chart-pie mr-1"></i>Kort Doluluk Oranları </h3>

                            <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                                    <i class="fas fa-minus"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body p-0">
                            <table style="text-align:center" class="table">
                                <thead>
                                    <tr>
                                        <th>Kortlar</th>
                                        <th>Doluluk Oranı</th>

                                    </tr>
                                </thead>
                                <tbody>

                                    @{
                                        DateTime date1 = DateTime.Now;
                                        var today = date1.ToString("yyyy-MM-dd");
                                    }


                                    @foreach (var item2 in Model.courts)
                                    {

                                        var a = Model.reservations.Where(x => x.Court.CourtId == item2.CourtId && x.ResDate == today).ToList();
                                        var count = a.Count();
                                        var percent = (count * 100) / 17;
                                        <tr>
                                            <td>@item2.CourtName</td>
                                            <td>

                                                <div class="progress1">
                                                    <div class="progress-value1" style="width: @percent%"><span>@percent%</span></div>
                                                </div>

                                            </td>
                                        </tr>
                                    }

                                </tbody>
                            </table>
                        </div>                    
                    </div>                
                </section>             
            </div>            
        </div>
    </section>
</div>


<footer class="main-footer">
    <strong>Copyright &copy; 2014-2020 <a href="https://adminlte.io">AdminLTE.io</a>.</strong>
    All rights reserved.
    <div class="float-right d-none d-sm-inline-block">
        <b>Version</b> 3.1.0-rc
    </div>
</footer>


<!-- Modal -->
<div class="modal fade" id="openToDoModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Yapılacak Listesi</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="col-md-12 form-group">
                    <input type="text" id="toDo" class="form-control" autocomplete="new-password">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Kapat</button>
                <button type="button" class="btn btn-primary" onclick="addToDo()">Ekle</button>
            </div>
        </div>
    </div>
</div>
<script src="~/lib/jquery/dist/jquery.min.js"></script>



<script>
    function addToDo() {

        var d = new Date();
        var today = d.getDate() + "-" + (d.getMonth() + 1) + "-" + d.getFullYear();

        if ($("#toDo").val() == "") {

            swal({
                title: "Uyarı !",
                text: "Lütfen Eksizsiz Doldurunuz!",
                icon: "warning",
                button: "Tamam",
            });
        }

        else {


            $.ajax({
                type: "POST",
                url: '../Home/AddToDo',
                cache: false,
                data: { "toDo": $("#toDo").val(), "today": today },
                dataType: "json",
                async: true,
                success: function (res) {


                    if (res == true) {

                        $('#openToDoModal').modal('toggle')

                        swal({
                            title: "Yapılacak Listesine Eklendi !",
                            text: "İş Yükü Başarılı Bir Şekilde Eklendi !",
                            icon: "success",
                            button: "Tamam",
                        }).then((value) => {

                            window.location.href = "Index"

                        });

                    }

                    else {
                        $.confirm({
                            title: "Uyarı",
                            content: "Kayıt sırasında bir hata oluştu.",
                            buttons: {
                                TAMAM: function () {

                                    window.location.href = "Index"
                                }

                            }
                        });
                    }

                },

                error: function (textStatus, errorThrown) {
                    console.log(JSON.stringify(textStatus));
                    console.log(textStatus);
                }
            });
        }

    }
</script>