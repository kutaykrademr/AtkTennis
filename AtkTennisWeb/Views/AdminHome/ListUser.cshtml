@model Helpers.Dto.PartialViewDtos.IdentityPartialViewDto;


<div class="content-wrapper">
    <section class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1>Kullanıcılar</h1>
                </div>
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="#">Home</a></li>
                        <li class="breadcrumb-item active">DataTables</li>
                    </ol>
                </div>
            </div>
        </div>
    </section>



    <section class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="card">

                        <section class="content">
                            <div class="container-fluid">
                                <div class="card" style="border-radius:40px; margin-top:20px">
                                    <div class="card-content">
                                        <div class="card-body cleartfix">
                                            <div class="media align-items-stretch">

                                                <div class="align-self-center">
                                                    <i style="font-size:60px; margin-right:20px ; color:darkmagenta" class="fas fa-list-ol"></i>
                                                </div>
                                                <div style="margin-top:10px" class="media-body">
                                                    <h3>Kullanıcı Listeleri</h3>
                                                </div>

                                                <div class="align-self-center">
                                                    <h3><i style="font-size:25px; margin-left:10px ; color:darkmagenta" class="fas fa-plus"></i></h3>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>


                        <div class="card-body">
                            <table id="example1" class="table table-bordered table-hover">
                                <thead>
                                    <tr style="text-align:center">
                                        <th>Adı </th>
                                        <th>E-Mail</th>
                                        <th>Telefon Numarası</th>
                                        <th>Role</th>

                                        <th>İşlemler</th>

                                    </tr>
                                </thead>
                                <tbody>

                                    @foreach (var item in Model.memberLists)
                                    {
                                        <tr style="text-align:center" id="">
                                            <td>@item.FullName</td>
                                            <td>@item.Email</td>
                                            <td>@item.Phone</td>
                                            <td>@item.Role</td>


                                            <td>
                                                <button class="btn btn-outline-success" id="@item.UserId" onclick="openUpdateModal(this.id)"><i class="fas fa-edit"></i></button>
                                                <button class="btn btn-outline-warning" id="@item.UserId" onclick="showUserInf(this.id) "><i class="fas fa-search"></i></button>
                                                <button class="btn btn-outline-danger" id="@item.UserId" onclick="openDeleteUserModal(this.id) "><i class="fas fa-trash"></i></button>

                                            </td>

                                        </tr>
                                    }


                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<div class="modal fade" id="updateModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <div class="card">
                    <div class="card-body register-card-body">
                        <p class="login-box-msg">Kayıt Formu </p>
                        <div>
                            <div class="row">
                                <div class="input-group mb-3 col-md-6">
                                    <input type="text" class="form-control" id="name" placeholder="Adı Soyadı" autocomplete="new-password">
                                    <div class="input-group-append">
                                        <div class="input-group-text">
                                            <span class="fas fa-user"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="input-group mb-3 col-md-6">
                                    <input type="text" class="form-control" id="username" placeholder="Kullanıcı Adı" autocomplete="new-password">
                                    <div class="input-group-append">
                                        <div class="input-group-text">
                                            <span class="fas fa-user"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-group mb-3 col-md-6">
                                    <input placeholder="Başlangıç Tarihi" type="text" class="form-control" id="startDate" data-inputmask-alias="datetime" data-inputmask-inputformat="dd/mm/yyyy" data-mask="" inputmode="numeric" autocomplete="new-password">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text"><i class="far fa-calendar-alt"></i></span>
                                    </div>
                                </div>
                                <div class="input-group mb-3 col-md-6">
                                    <input placeholder="Bitiş Tarihi" type="text" class="form-control" id="finishDate" data-inputmask-alias="datetime" data-inputmask-inputformat="dd/mm/yyyy" data-mask="" inputmode="numeric" autocomplete="new-password">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text"><i class="far fa-calendar-alt"></i></span>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-md-6">
                                    <select id="RegistersRole" class="form-control">
                                        <option disabled="disabled" selected>Türü</option>
                                        @for (int i = 0; i < Model.AppIdentityRoles.Count(); i++)
                                        {
                                            <option>@Model.AppIdentityRoles[i].NormalizedName</option>
                                        }

                                    </select>
                                </div>
                                <div class="form-group col-md-6">
                                    <select id="condition" class="form-control">
                                        <option disabled="disabled" selected>Durumu</option>
                                        <option>Faal</option>
                                        <option>Çıkan</option>
                                        <option>Dondurulmuş</option>
                                        <option>Fahri</option>
                                        <option>İstifa</option>
                                        <option>Onur</option>
                                        <option>Vefat</option>
                                        <option>Belirtilmemiş</option>
                                    </select>
                                </div>
                            </div>

                            <div class="row">
                                <div class="input-group mb-3 col-md-6">
                                    <input type="email" class="form-control" placeholder="T.C Kimlik" id="identificationNumber" autocomplete="new-password">
                                    <div class="input-group-append">
                                        <div class="input-group-text">
                                            <span class="fas fa-envelope"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group col-md-6">
                                    <select id="webReservation" class="form-control">
                                        <option disabled="disabled" selected>Web Rezervasyon</option>

                                        <option value="1">Yapabilir</option>
                                        <option value="2">Yapamaz</option>

                                    </select>
                                </div>
                            </div>
                            <div class="row">

                                <div class="input-group mb-3 col-md-6">
                                    <input placeholder="Telefon No" id="phone" type="text" class="form-control" data-inputmask="&quot;mask&quot;: &quot;(999) 999-9999&quot;" data-mask="" inputmode="text" autocomplete="new-password">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text"><i class="fas fa-phone"></i></span>
                                    </div>
                                </div>

                                <div class="input-group mb-3 col-md-6">
                                    <input type="text" class="form-control" id="phoneExp" placeholder="Tel Açıklama" autocomplete="new-password">
                                    <div class="input-group-append">
                                        <div class="input-group-text">
                                            <span class="fas fa-user"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="input-group mb-3 col-md-6">
                                    <input placeholder="Telefon No" id="phone2" type="text" class="form-control" data-inputmask="&quot;mask&quot;: &quot;(999) 999-9999&quot;" data-mask="" inputmode="text" autocomplete="new-password">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text"><i class="fas fa-phone"></i></span>
                                    </div>
                                </div>

                                <div class="input-group mb-3 col-md-6">
                                    <input type="text" class="form-control" id="phone2Exp" placeholder="Tel Açıklama" autocomplete="new-password">
                                    <div class="input-group-append">
                                        <div class="input-group-text">
                                            <span class="fas fa-user"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="input-group mb-3 col-md-6">
                                    <input type="email" class="form-control" id="email" placeholder="Email" autocomplete="new-password">
                                    <div class="input-group-append">
                                        <div class="input-group-text">
                                            <span class="fas fa-envelope"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="input-group mb-3 col-md-6">
                                    <input type="text" class="form-control" id="emailExp" placeholder="Email Açıklama" autocomplete="new-password">
                                    <div class="input-group-append">
                                        <div class="input-group-text">
                                            <span class="fas fa-user"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-group mb-3 col-md-6">
                                    <input placeholder="Doğum Tarihi" id="birthdate" type="text" class="form-control" data-inputmask-alias="datetime" data-inputmask-inputformat="dd/mm/yyyy" data-mask="" inputmode="numeric" autocomplete="new-password">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text"><i class="far fa-calendar-alt"></i></span>
                                    </div>
                                </div>
                                <div class="input-group mb-3 col-md-6">
                                    <input type="text" class="form-control" id="birthPlace" placeholder="Doğum Yeri" autocomplete="new-password">
                                    <div class="input-group-append">
                                        <div class="input-group-text">
                                            <span class="fas fa-user"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-group mb-3 col-md-6">
                                    <input type="text" class="form-control" id="motherName" placeholder="Anne Adı" autocomplete="new-password">
                                    <div class="input-group-append">
                                        <div class="input-group-text">
                                            <span class="fas fa-user"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="input-group mb-3 col-md-6">
                                    <input type="text" class="form-control" id="fatherName" placeholder="Baba Adı" autocomplete="new-password">
                                    <div class="input-group-append">
                                        <div class="input-group-text">
                                            <span class="fas fa-user"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-group mb-3 col-md-6">
                                    <input type="text" class="form-control" id="city" placeholder="Şehir" autocomplete="new-password">
                                    <div class="input-group-append">
                                        <div class="input-group-text">
                                            <span class="fas fa-user"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="input-group mb-3 col-md-6">
                                    <input type="text" class="form-control" id="district" placeholder="İlçe" autocomplete="new-password">
                                    <div class="input-group-append">
                                        <div class="input-group-text">
                                            <span class="fas fa-user"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-group mb-3 col-md-6">
                                    <input type="text" class="form-control" id="job" placeholder="Meslek" autocomplete="new-password">
                                    <div class="input-group-append">
                                        <div class="input-group-text">
                                            <span class="fas fa-user"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="input-group mb-3 col-md-6">
                                    <input type="text" class="form-control" id="note" placeholder="Not" autocomplete="new-password">
                                    <div class="input-group-append">
                                        <div class="input-group-text">
                                            <span class="fas fa-user"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="input-group mb-3">
                                <input type="text" class="form-control" id="password" placeholder="Password" autocomplete="new-password">
                                <div class="input-group-append">
                                    <div class="input-group-text">
                                        <span class="fas fa-lock"></span>
                                    </div>
                                </div>
                            </div>
                            <div style="visibility:hidden" class="input-group mb-3">
                                <input type="text" class="form-control" id="checkpassword" placeholder="Retype password" autocomplete="new-password">
                                <div class="input-group-append">
                                    <div class="input-group-text">
                                        <span class="fas fa-lock"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" id="updateModel">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Kapat</button>
                <button type="button" class="btn btn-primary" onclick="updateMemberList(this.id)">Güncelle</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="openDeleteUserModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Uyarı</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Silmek İstediğinize Emin Misiniz ?
            </div>
            <div class="modal-footer" id="deleteOperationModel">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Kapat</button>
                <button type="button" class="btn btn-primary" onclick="deleteUser(this.id)">Sil</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="showUserModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style="max-width:1500px" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <div class="row">
                    <div class="col-12">

                        <div class="card">
                            <div class="card-header d-flex p-0">
                                <h3 class="card-title p-3">Kullanıcı Bilgileri</h3>
                                <ul class="nav nav-pills ml-auto p-2">
                                    <li class="nav-item"><a class="nav-link active" style="background-color:darkmagenta; color:white; margin-right:10px" href="#tab_1" data-toggle="tab">Üyelik Bilgileri</a></li>
                                    <li class="nav-item"><a class="nav-link" href="#tab_2" style="background-color:darkmagenta; color:white" data-toggle="tab">Rezervasyon Listesi</a></li>
                                </ul>
                            </div>
                            <div class="card-body">
                                <div class="tab-content">
                                    <div class="tab-pane active" id="tab_1">

                                        <section class="content">
                                            <div class="container-fluid">
                                                <div class="card" style="border-radius:40px">
                                                    <div class="card-content">
                                                        <div class="card-body cleartfix">
                                                            <div class="media align-items-stretch">
                                                                <div class="align-self-center">
                                                                    <i style="font-size:60px; margin-right:20px ; color:darkmagenta" class="fas fa-id-card"></i>
                                                                </div>
                                                                <div class="media-body" id="identityCard">

                                                                </div>



                                                                <div class="align-self-center">
                                                                    <h3>Toplam Bakiye: 375 ₺<i style="font-size:25px; margin-left:10px ; color:darkmagenta" class="fas fa-tags"></i></h3>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </section>


                                        <section class="content">
                                            <div class="container-fluid">

                                                <div class="row">
                                                    <div class="col-lg-3 col-6">
                                                        <!-- small box -->
                                                        <div class="small-box bg-info">
                                                            <div class="inner">

                                                                <h3 style="font-size:20px" id="startDateModal"></h3>
                                                                <p>Başlangıç Tarihi</p>
                                                            </div>
                                                            <div class="icon">
                                                                <i class="ion ion-bag"></i>
                                                            </div>
                                                            <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                                                        </div>
                                                    </div>
                                                    <!-- ./col -->
                                                    <div class="col-lg-3 col-6">
                                                        <!-- small box -->
                                                        <div class="small-box bg-success">
                                                            <div class="inner">

                                                                <h3 style="font-size:20px" id="finishDateModal"></h3>
                                                                <p>Bitiş Tarihi</p>
                                                            </div>
                                                            <div class="icon">
                                                                <i class="ion ion-stats-bars"></i>
                                                            </div>
                                                            <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                                                        </div>
                                                    </div>
                                                    <!-- ./col -->
                                                    <div class="col-lg-3 col-6">
                                                        <!-- small box -->
                                                        <div class="small-box bg-warning">
                                                            <div class="inner">
                                                                <h3 style="font-size:20px" id="RoleModal"></h3>

                                                                <p>Kullanıcı Yetkisi</p>
                                                            </div>
                                                            <div class="icon">
                                                                <i class="ion ion-person-add"></i>
                                                            </div>
                                                            <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                                                        </div>
                                                    </div>
                                                    <!-- ./col -->
                                                    <div class="col-lg-3 col-6">
                                                        <!-- small box -->
                                                        <div class="small-box bg-danger">
                                                            <div class="inner">
                                                                <h3 style="font-size:20px" id="ConditionModal"></h3>

                                                                <p>Kullanıcı Durumu</p>
                                                            </div>
                                                            <div class="icon">
                                                                <i class="ion ion-pie-graph"></i>
                                                            </div>
                                                            <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                                                        </div>
                                                    </div>
                                                    <!-- ./col -->
                                                </div>

                                                <!-- /.row -->
                                                <div class="row">
                                                    <div class="col-lg-6">
                                                        <div class="card card-primary ">
                                                            <div class="card-header">
                                                                <h3 class="card-title">Kişisel Bilgileri</h3>
                                                            </div>

                                                            <div class="card-body">
                                                                <strong><i class="fas fa-book mr-1"></i> Adı - Soyadı</strong>

                                                                <p id="fullNameModal" class="text-muted">

                                                                </p>

                                                                <hr>

                                                                <strong><i class="fas fa-pencil-alt mr-1"></i> T.C. Kimlik Numarası</strong>

                                                                <p id="idNumberModal" class="text-muted">


                                                                </p>

                                                                <hr>

                                                                <strong><i class="fas fa-map-marker-alt mr-1"></i> Doğum Tarihi - Doğum Yeri</strong>

                                                                <p id="birDatePlace" class="text-muted">

                                                                </p>

                                                                <hr>

                                                                <strong><i class="fas fa-pencil-alt mr-1"></i> Telefon Numarası</strong>

                                                                <p id="phoneNumberModal" class="text-muted">

                                                                </p>

                                                                <hr>

                                                                <strong><i class="fas fa-pencil-alt mr-1"></i> E-Posta Adresi</strong>

                                                                <p id="emailModal" class="text-muted">

                                                                </p>

                                                                <hr>

                                                                <strong><i class="fas fa-pencil-alt mr-1"></i>Meslek</strong>

                                                                <p id="jobModal" class="text-muted">


                                                                </p>
                                                            </div>

                                                        </div>
                                                    </div>

                                                    <div class="col-lg-6">
                                                        <div class="card card-primary ">
                                                            <div class="card-header">
                                                                <h3 class="card-title">Bilgi Devam</h3>
                                                            </div>

                                                            <div class="card-body">
                                                                <strong><i class="fas fa-book mr-1"></i> Anne - Baba Adı</strong>

                                                                <p id="momFatherNameModal" class="text-muted">

                                                                </p>

                                                                <hr>

                                                                <strong><i class="fas fa-pencil-alt mr-1"></i>Aile Telefon Numarası</strong>

                                                                <p id="famPhoneModal" class="text-muted">

                                                                </p>

                                                                <hr>

                                                                <strong><i class="fas fa-map-marker-alt mr-1"></i> Şehir - İlçe</strong>

                                                                <p id="cityModal" class="text-muted"></p>

                                                                <hr>

                                                                <strong><i class="far fa-file-alt mr-1"></i> Notlar</strong>

                                                                <p id="noteModal" class="text-muted"></p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>
                                        </section>
                                    </div>

                                    <div class="tab-pane" id="tab_2">
                                        <section class="content">
                                            <div class="container-fluid">
                                                <div class="card" style="border-radius:40px">
                                                    <div class="card-content">
                                                        <div class="card-body cleartfix">
                                                            <div class="media align-items-stretch">
                                                                <div class="align-self-center">
                                                                    <i style="font-size:60px; margin-right:20px ; color:darkmagenta" class="fas fa-id-card"></i>
                                                                </div>
                                                                <div class="media-body">
                                                                    <h4 id="full_nick"></h4>
                                                                    <span id="sp_user">username</span>
                                                                </div>



                                                                <div class="align-self-center">
                                                                    <h3 id="totalPrice"><i style="font-size:25px; margin-left:10px ; color:darkmagenta" class="fas fa-tags"></i></h3>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </section>

                                        <section class="content">
                                            <div class="container-fluid">
                                                <div class="row">
                                                    <div class="col-lg-3 col-6">
                                                        <div class="small-box bg-info">
                                                            <div class="inner">
                                                                <h3 id="debtCount"></h3>
                                                                <p>Ödenmeyen Rezervasyonlar</p>
                                                            </div>
                                                            <div class="icon">
                                                                <i class="far fa-window-close"></i>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="col-lg-3 col-6">
                                                        <div class="small-box bg-success">
                                                            <div class="inner">
                                                                <h3 id="debtNotCount"></h3>

                                                                <p>Ödeme Yapılan Rezervasyonlar</p>
                                                            </div>
                                                            <div class="icon">
                                                                <i class="far fa-check-square"></i>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="col-lg-3 col-6">
                                                        <div class="small-box bg-warning">
                                                            <div class="inner">
                                                                <h3 id="cancelResCount"></h3>

                                                                <p>İptal Edilen Rezervasyonlar</p>
                                                            </div>
                                                            <div class="icon">
                                                                <i class="far fa-bell-slash"></i>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="col-lg-3 col-6">
                                                        <div class="small-box bg-danger">
                                                            <div class="inner">
                                                                <h3 id="totalPrice2"> </h3>

                                                                <p>Toplam Borç</p>
                                                            </div>
                                                            <div class="icon">
                                                                <i class="fas fa-money-check-alt"></i>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </section>

                                        <section class="content">
                                            <div class="container-fluid" id="resListModal">



                                            </div>
                                        </section>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<script>
    $(document).ready(function () {



        $('#datemask').inputmask('dd/mm/yyyy', { 'placeholder': 'dd/mm/yyyy' })
        $('[data-mask]').inputmask()
        $('#reservationdate').datetimepicker({
            format: 'L'
        });



        $("#example1").DataTable({
            "responsive": true, "lengthChange": false, "autoWidth": false,
            "buttons": [/*"copy", "csv", "excel",*/ "pdf", "print"/*, "colvis"*/]
        }).buttons().container().appendTo('#example1_wrapper .col-md-6:eq(0)');

        $('#example2 , #example3 , #example4').DataTable({
            "paging": true,
            "lengthChange": false,
            "searching": false,
            "ordering": true,
            "info": true,
            "autoWidth": false,
            "responsive": true,
        });

    });

    function openDeleteUserModal(id) {

        $("#deleteOperationModel button:nth-of-type(2)").attr("id", id);
        $("#openDeleteUserModal").modal("toggle");

    }
    function showUserInf(id) {



        $.ajax({
            type: "POST",
            url: '../Public/GetUserListModal',
            cache: false,
            data: { "id": id },
            dataType: "json",
            async: true,
            success: function (res) {



                if (res != null) {

                  

                       $("#identityCard").empty();
                    for (var i = 0; i < res.memberLists.length; i++) {
                        row = "";
                        row += ' <h4>' + res.memberLists[i].fullName + '-' + res.memberLists[i].nickName + '</h4 > ';
                        row += '<span>' + res.memberLists[i].userName + '</span>';

                        $("#identityCard").append(row);


                        myString = res.memberLists[i].role;;
                        firstChar = myString.substring(0, 1);
                        tail = myString.substring(1);
                        Lowertail = tail.toLowerCase();
                        role = firstChar + Lowertail;


                        $("#startDateModal").text(res.memberLists[i].startDate);
                        $("#finishDateModal").text(res.memberLists[i].finishDate);
                        $("#RoleModal").text(role);
                        $("#ConditionModal").text(res.memberLists[i].condition);
                        $("#fullNameModal").text(res.memberLists[i].fullName);
                        $("#idNumberModal").text(res.memberLists[i].identityNumber);
                        $("#birDatePlace").text(res.memberLists[i].birthDate + '-' + res.memberLists[i].birthPlace);
                        $("#phoneNumberModal").text(res.memberLists[i].phone + '-' + res.memberLists[i].phoneExp);
                        $("#emailModal").text(res.memberLists[i].email + '-' + res.memberLists[i].emailExp);
                        $("#momFatherNameModal").text(res.memberLists[i].motherName + '-' + res.memberLists[i].fatherName);
                        $("#cityModal").text(res.memberLists[i].city + '-' + res.memberLists[i].district);
                        $("#famPhoneModal").text(res.memberLists[i].phone2 + '-' + res.memberLists[i].phone2Exp);
                        $("#noteModal").text(res.memberLists[i].note);
                        $("#jobModal").text(res.memberLists[i].job);


                        //ResListModal
                  
                        $("#full_nick").text(res.memberLists[i].fullName + '-' + res.memberLists[i].nickName);
                        $("#sp_user").text(res.memberLists[i].userName);
                        $("#debtCount").text(res.debtCount);
                        $("#debtNotCount").text(res.debtNotCount);
                        $("#cancelResCount").text(res.cancelResCount);

                        var totalPrice = 0;

                        for (var i = 0; i < res.reservations.length; i++) {

                            if (res.reservations[i].priceInf == false) {
                                var firstPrice = parseInt(res.reservations[i].price);
                                totalPrice = firstPrice + parseInt(totalPrice);
                            }

                        }

                        $("#totalPrice").text("Toplam Borç :"+ ' ' +totalPrice + ' '+'₺');
                        $("#totalPrice2").text(totalPrice +' '+'₺');
                    }

                    $("#resListModal").empty();

                    for (var i = 0; i < res.date.length; i++)
                    {
                        row = "";
                        row += ' <div class="card">';
                        row += '<div class="card-header d-flex justify-content-between">';
                        row += '<div class="card-title">';
                        row += '<h3>' + res.date[i] + ' Yılına Ait Rezervasyonlar' + '</h3>';
                        row += '</div></div>';
                        row += '<div class="card-body">';
                        row += '<table id="example2" class="table table-bordered table-hover">';
                        row += ' <thead>';
                        row += '<tr style="text-align:center">';
                        row += '<th>Tarih</th>';
                        row += '<th>Saat</th>';
                        row += '<th>Kort Bilgisi</th>';
                        row += '<th>Ücret Detayı</th>';
                        row += '<th>Ücret Durumu</th>';
                        row += '<th>Durumu</th>';
                        row += '<th>İşlemler</th>';
                        row += '<tr>';
                        row += '</thead>';
                        row += '</tbody>';

                        for (var a = 0; a < res.reservations.length; a++)
                        {
                         
                            if (res.reservations[a].resDate.split("-")[0] == res.date[i])
                            {
                                row += '<tr style="text-align:center">';
                                row += '<td>' + res.reservations[a].resDate + '</td>';
                                row += '<td>' + res.reservations[a].resStartTime + "- " + res.reservations[a].resFinishTime + '</td>';
                                row += '<td>' + res.reservations[a].court.courtName + '</td>';
                                row += '<td>' + res.reservations[a].price + "₺" + '</td>';

                                if (res.reservations[a].priceInf == false)
                                
                                    row += '<td>' + "Ödenmedi" + '</td>';
                                
                                else
                                
                                    row += '<td>' + "Ödendi" + '</td>';
                                
                                row += '<td>Aktif</td>';
                                row += '<td>';
                                row += '<button style="color:white; background-color:#17a2b8 ; border-color:#17a2b8" class="btn btn-warning"><i style="margin-right:6px" class="far fa-credit-card"></i>Ödeme</button>';
                                row += '<button style="color:white; background-color:#17a2b8 ; border-color:#17a2b8" class="btn btn-warning"><i style="margin-right:6px" class="far fa-credit-card"></i>TopluÖdeme</button>';
                                row += '</td>';
                                row += '</tr>';

                            }
                        }
                        row += '</tbody>';
                        row += '</table>';
                        row += '</div>';
                        row += '<div>';

                        $("#resListModal").append(row);
                    }

                    
                   




                    $("#showUserModal").modal("toggle");
                }

                else {
                    $.confirm({
                        title: "Uyarı",
                        content: "Bir Hata Oluştu.",
                        buttons: {
                            TAMAM: function () {

                            }
                        }
                    });
                }

            },
            error: function (textStatus, errorThrown) {
                console.log(JSON.stringify(textStatus));
                console.log(textStatus);
            }
        });

        $("#showUserModal").modal("toggle");
    }

    function deleteUser(id) {

        $.ajax({
            type: "POST",
            url: '../AdminHome/DeleteUser',
            cache: false,
            data: { "id": id },
            dataType: "json",
            async: true,
            success: function (res) {


                if (res != false) {

                    $("#openDeleteUserModal").modal("toggle");

                    $.confirm({
                        title: "Bilgilendirme",
                        content: "Kullanıcı başarıyla silindi.",
                        buttons: {
                            TAMAM: function () {

                                window.location.href = "ListUser"
                            }
                        }
                    });
                }

                else {
                    $.confirm({
                        title: "Uyarı",
                        content: "Bir Hata Oluştu.",
                        buttons: {
                            TAMAM: function () {

                            }
                        }
                    });
                }

            },
            error: function (textStatus, errorThrown) {
                console.log(JSON.stringify(textStatus));
                console.log(textStatus);
            }
        });
    }

    function openUpdateModal(id) {
        $.ajax({
            type: "GET",
            url: '../AdminHome/GetMemberList',
            cache: false,
            data: { "id": id },
            dataType: "json",
            async: true,
            success: function (res) {


                if (res != null) {

                    $("#name").val(res.fullName);
                    $("#username").val(res.userName);
                    $("#startDate").val(res.startDate);
                    $("#finishDate").val(res.finishDate);
                    $("#RegistersRole option:selected").text(res.role);
                    $("#condition option:selected").text(res.condition);
                    $("#identificationNumber").val(res.identityNumber);
                    $("#webReservation option:selected").text(res.webReservation);
                    $("#phone").val(res.phone);
                    $("#phoneExp").val(res.phoneExp);
                    $("#phone2").val(res.phone2);
                    $("#phone2Exp").val(res.phone2Exp);
                    $("#email").val(res.email);
                    $("#emailExp").val(res.emailExp);
                    $("#birthdate").val(res.birthDate);
                    $("#birthPlace").val(res.birthPlace);
                    $("#motherName").val(res.motherName);
                    $("#fatherName").val(res.fatherName);
                    $("#city").val(res.city);
                    $("#district").val(res.district);
                    $("#job").val(res.job);
                    $("#note").val(res.note);
                    $("#password").val(res.password);
                    $("#checkpassword").val(res.password);


                    $("#updateModel button:nth-of-type(2)").attr("id", id);
                    $('#updateModal').modal('toggle');
                }

                else {
                    $.confirm({
                        title: "Uyarı",
                        content: "Üye Bulunamadı.",
                        buttons: {
                            TAMAM: function () {

                            }
                        }
                    });
                }

            },
            error: function (textStatus, errorThrown) {
                console.log(JSON.stringify(textStatus));
                console.log(textStatus);
            }
        });
    }

    function updateMemberList(id) {

        userObj = {

            id: null,
            name: null,
            username: null,
            startDate: null,
            finishDate: null,
            role: null,
            condition: null,
            identificationNumber: null,
            webReservation: null,
            phone: null,
            phoneExp: null,
            phone2: null,
            phone2Exp: null,
            email: null,
            emailExp: null,
            birthdate: null,
            birthPlace: null,
            motherName: null,
            fatherName: null,
            city: null,
            district: null,
            job: null,
            note: null,
            password: null,
            gender: null,
            checkpass: null,

        };



        if ($("#RegistersRole option:nth-of-type(1)").text() == $("#select2-RegistersRole-container").text()) {

            $.confirm({
                title: "Uyarı",
                content: "Lütfen Rol Seçiniz",
                buttons: {
                    TAMAM: function () {


                    }
                }
            });

        } else {



            userObj.checkpass = $("#checkpassword").val();
            userObj.id = id;
            userObj.name = $("#name").val();
            userObj.username = $("#username").val();
            userObj.startDate = $("#startDate").val();
            userObj.finishDate = $("#finishDate").val();
            userObj.role = $("#RegistersRole option:selected").text();
            userObj.condition = $("#condition option:selected").text();
            userObj.identificationNumber = $("#identificationNumber").val();
            userObj.webReservation = $("#webReservation option:selected").val();
            userObj.phone = $("#phone").val();
            userObj.phoneExp = $("#phoneExp").val();
            userObj.phone2 = $("#phone2").val();
            userObj.phone2Exp = $("#phone2Exp").val();
            userObj.email = $("#email").val();
            userObj.emailExp = $("#emailExp").val();
            userObj.birthdate = $("#birthdate").val();
            userObj.birthPlace = $("#birthPlace").val();
            userObj.motherName = $("#motherName").val();
            userObj.fatherName = $("#fatherName").val();
            userObj.city = $("#city").val();
            userObj.district = $("#district").val();
            userObj.job = $("#job").val();
            userObj.note = $("#note").val();
            userObj.password = $("#password").val();
            userObj.gender = "Male";



            if (userObj.password != "" || userObj.username != "") {

                try {
                    $.ajax({
                        type: "Post",
                        url: '../AdminHome/UpdateMemberList',
                        cache: false,
                        data: userObj,
                        dataType: "json",
                        async: true,
                        success: function (res) {



                            if (res == true) {
                                $('#updateModal').modal('toggle');

                                $.confirm({
                                    title: "Bilgilendirme",
                                    content: "Kullanıcı Başarıyla Güncellendi.",
                                    buttons: {
                                        TAMAM: function () {

                                            window.location.href = "ListUser"

                                        }
                                    }
                                });
                            }

                            else
                                $.confirm({
                                    title: "Uyarı",
                                    content: "Kullanıcı Güncellenirken Hata Oluştu. Şifre : En az bir büyük harf , Küçük Harf , Sayı ve Sembol(*/.) içermelidir.",
                                    buttons: {
                                        TAMAM: function () {


                                        }
                                    }
                                });

                        },
                        error: function (textStatus, errorThrown) {
                            console.log(JSON.stringify(textStatus));
                            console.log(textStatus);
                        }
                    });
                } catch (e) {
                    console.log(e.message);
                }
            }
            else {
                $.confirm({
                    title: "Uyarı",
                    content: "Kullanıcı Adı / Şifre Boş Bırakılamaz",
                    buttons: {
                        TAMAM: function () {


                        }
                    }
                });

            }

        }

    }




</script>
